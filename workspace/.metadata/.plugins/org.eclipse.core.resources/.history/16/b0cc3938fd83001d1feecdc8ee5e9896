package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

public class AdminDaoImpl implements AdminDao {
	private Connection conn;

	public AdminDaoImpl(Connection conn) {
		this.conn = conn;
	}
	@Override
	public boolean findAdmin(String name, String pass) throws SQLException {
		String sql = "SELECT * FROM [Vortex].[dbo].[Admin] WHERE name =? AND password =?";
		PreparedStatement stmt = conn.prepareStatement(sql);
		stmt.setString(1,request.getParameter("username"));
		stmt.setString(2,request.getParameter("password"));
		ResultSet rs = stmt.executeQuery();
		if (rs.next()) {
			HttpSession session = ((HttpServletRequest) request).getSession();
			session.setAttribute("name", request.getParameter("username"));
			session.setAttribute("pass", request.getParameter("password"));
		conn.close();
		} else {
			((HttpServletResponse) response).sendRedirect("/Vortex/view/login.html");
		}
		return false;
	}

}
